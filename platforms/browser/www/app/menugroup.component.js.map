{"version":3,"file":"menugroup.component.js","sourceRoot":"","sources":["menugroup.component.ts"],"names":[],"mappings":"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","sourcesContent":["import {Component, Input, Pipe, Output, EventEmitter} from '@angular/core';\nimport {AngularFire} from 'angularfire2';\nimport {FirebaseListObservable} from 'angularfire2';\nimport {DataService} from './data.service';\nimport {OnInit} from '@angular/core';\nimport {Postnote2App} from './postNote2.component';\nimport { Injectable, Inject } from '@angular/core';\nimport { defaultFirebase, FirebaseRef } from 'angularfire2';\nimport { Observable } from 'rxjs/Observable';\nimport {ValueService} from './value.service';\nimport {LocalStorageService} from './localstorage.service';\nimport { Dragula } from 'ng2-dragula/ng2-dragula';\n\n@Component({\n  moduleId: module.id,\n  selector: 'menuGroup',\n  providers: [LocalStorageService, Dragula],\n  templateUrl: 'menugroup.component.html',\n  styleUrls: ['menugroup.component.css'],\n  pipes: []\n})\n\n\nexport class MenuGroupComponent implements OnInit {\n  arrowSrc: string = 'icon_expand.png';\n  expanded: boolean;\n  editingName: boolean = false;\n  notes: any;\n\n  @Input()\n  groups: any;\n  \n  @Input()\n  group;\n  _authData;\n  editSrc: string = 'icon_edit.png';\n\n  @Output() groupsChanged = new EventEmitter();\n\n  constructor( @Inject(FirebaseRef) private _ref: Firebase, private _ds: DataService, private _tx: ValueService, private _ls: LocalStorageService) {\n\n    this._authData = this._ref.getAuth();\n  }\n\n  ngOnInit() {\n    this.getNotes();\n  }\n\n  saveId(){\n    this._tx._focusedId = this.group.$key;\n  }\n\n  getNotes() {\n    if (this._authData != null) {\n      this._ds.getAllNotesInGroup(this.group.name).then(titles => this.notes = titles);\n    } else {\n      this.notes = this._ls.getNotesInGroup(this.group.name);\n    }\n  }\n\n  deleteGroup() {\n    console.log(\"DELETE GROUP\");\n    //remove from shared model\n    for (var item in this.groups) {\n      console.log(\"CHECKING \" + this.groups[item].$key);\n            if (this.group.$key == this.groups[item].$key) {\n                console.log(\"REMOVING no \" + item);\n                this.groups.splice(item, 1);\n                break;\n            }\n    }\n    //remove from firebase\n    if (this._authData != null) {\n      this._ds.deleteGroup(this._tx._focusedId);\n    } else {//remove from local storage\n      this._ls.deleteGroup(this._tx._focusedId);\n      //TEMPORARY\n      //location.reload();\n    }\n    this._tx._toggleExpand = false;\n    this.groupsChanged.emit(this.groups);\n  }\n\n\n  editGroup() {\n    if (this._authData != null) {\n      this._ds.updateGroupName(this.group.$key, this.group.name);\n    } else {\n      this._ls.updateGroupName(this.group.$key, this.group.name);\n      //Not sure how this can work!\n      \n      //TEMPORARY\n      //location.reload();\n    }\n    //this.groupsChanged.emit('');\n  }\n\n  getContent() {\n    let doneInLoopArray;\n    let arrayOfKeys: any[] = [];\n    this.notes.forEach(function (result) {\n      doneInLoopArray = result;\n    });\n    doneInLoopArray.forEach(function (note) {\n      arrayOfKeys.push(note.$key);\n    });\n    return arrayOfKeys;\n  }\n\n  //When pressing the edit button, it enables editing on the input field\n  editing() {\n    this.editingName = !this.editingName;\n    if (this.editingName) {\n      document.getElementById(this.group.$key).removeAttribute(\"readonly\");\n      document.getElementById(this.group.$key).focus();\n      this.editSrc = 'icon_save.png';\n    } else {\n      document.getElementById(this.group.$key).setAttribute(\"readonly\", \"true\");\n      if (this._authData != null) {\n        let content = this.getContent();\n        // changes notes in the group to the new group\n        for (let key of content) {\n          this._ds.changeNoteGroup(key, this.group.name);\n        }\n      } else { //if not logged in\n        for (let note of this.notes) {\n          this._ls.changeNoteGroup(note.$key, this.group.name);\n          \n        }\n      }\n      this.editSrc = 'icon_edit.png';\n      this.editGroup();\n      this.getNotes();\n      this._tx._toggleExpand = false;\n    }\n  }\n\n  toggleExpand() {\n    if (this.arrowSrc == 'icon_hide.png') {\n      this.expanded = false;\n    } else {\n      this.expanded = true;\n    }\n    // this.expanded = this._tx._toggleExpand;\n\n    if (this.expanded) {\n      this.arrowSrc = 'icon_hide.png';\n    }\n    else {\n      this.arrowSrc = 'icon_expand.png';\n    }\n  }\n\n  jumpToNote(note: string) {\n    var element = document.getElementById(note);\n    element.scrollIntoView(true);\n  }\n\n}"]}